## 2024-04-12 - [XSS in EPUB Status Reporting]
**Vulnerability:** A stored Cross-Site Scripting (XSS) vulnerability was found in the EPUB fixing tool. The application collected filenames and error details from the EPUB structure (which are user-controlled) and displayed them in the status report using `innerHTML` without sanitization. An attacker could craft a malicious EPUB file (e.g., with a file named `<img src=x onerror=alert(1)>`) that would execute arbitrary JavaScript when processed.
**Learning:** Even internal "system" messages or status reports can become vectors for XSS if they include data derived from user input (like filenames, XML content, etc.). Assuming that "status" messages are safe is a dangerous assumption.
**Prevention:** Always sanitize any variable content before injecting it into the DOM, even if it seems like a system-generated string. Use `textContent` where possible, or `escapeHtml` (or a similar sanitizer) when `innerHTML` is required for formatting.
